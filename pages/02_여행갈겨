# streamlit_seoul_top10.py
# Streamlit app that displays Seoul's top 10 tourist spots popular with foreign visitors using folium.
# This single-file app also writes a requirements.txt when run (so you have both files on Streamlit Cloud).

import streamlit as st
from streamlit_folium import st_folium
import folium
import webbrowser
import os

st.set_page_config(page_title="Seoul: Top 10 for Foreign Visitors", layout="wide")

st.title("Seoul — Top 10 Tourist Spots (popular with foreign visitors)")
st.write("Interactive Folium map showing 10 popular places foreigners often visit in Seoul. Click markers for a short description and a Google Maps link.")

# Center map roughly on Seoul
seoul_center = (37.5665, 126.9780)

# Top 10 list: name, lat, lon, short description
# Coordinates sourced from public geographic resources (Wikipedia / map sites).
PLACES = [
    {
        "name": "Gyeongbokgung Palace",
        "lat": 37.579884,
        "lon": 126.9768,
        "desc": "Historic main royal palace of the Joseon dynasty."
    },
    {
        "name": "Changdeokgung Palace",
        "lat": 37.57944,
        "lon": 126.99278,
        "desc": "UNESCO-listed palace known for its Secret Garden (Huwon)."
    },
    {
        "name": "Bukchon Hanok Village",
        "lat": 37.582178,
        "lon": 126.983256,
        "desc": "Traditional hanok neighborhood with narrow alleys and tea houses."
    },
    {
        "name": "Insadong",
        "lat": 37.5727,
        "lon": 126.9869,
        "desc": "Cultural shopping street with crafts, galleries and tea houses."
    },
    {
        "name": "Myeong-dong",
        "lat": 37.564,
        "lon": 126.985,
        "desc": "Major shopping district popular for cosmetics, street food and nightlife."
    },
    {
        "name": "N Seoul Tower (Namsan Tower)",
        "lat": 37.55117,
        "lon": 126.988228,
        "desc": "Iconic observation tower on Namsan mountain with panoramic views."
    },
    {
        "name": "Hongdae (Hongik University area)",
        "lat": 37.55528,
        "lon": 126.92333,
        "desc": "Youthful neighborhood famous for indie music, cafes and street performances."
    },
    {
        "name": "Dongdaemun Design Plaza (DDP)",
        "lat": 37.5669,
        "lon": 127.0094,
        "desc": "Futuristic cultural complex by Zaha Hadid, shopping and exhibitions."
    },
    {
        "name": "Lotte World Tower & Mall (Jamsil)",
        "lat": 37.512779,
        "lon": 127.10257,
        "desc": "South Korea's tallest building with observation deck and shopping mall."
    },
    {
        "name": "Itaewon",
        "lat": 37.533,
        "lon": 126.983,
        "desc": "Multicultural district known for international restaurants, nightlife and shops."
    }
]

# Create folium map
m = folium.Map(location=seoul_center, zoom_start=12, control_scale=True)

# Add markers
for p in PLACES:
    popup_html = f"<b>{p['name']}</b><br>{p['desc']}<br><a target='_blank' href='https://www.google.com/maps/search/?api=1&query={p['lat']},{p['lon']}'>Open in Google Maps</a>"
    folium.Marker(
        location=(p['lat'], p['lon']),
        popup=folium.Popup(popup_html, max_width=300),
        tooltip=p['name']
    ).add_to(m)

# Optional: add circle for city center
folium.Circle(location=seoul_center, radius=2000, fill=False, weight=1.2, dash_array='5').add_to(m)

# Display map in Streamlit
st.subheader("Map")
map_data = st_folium(m, width=900, height=600)

# Sidebar with list + quick links
st.sidebar.title("Top 10 — Quick list")
for i, p in enumerate(PLACES, start=1):
    st.sidebar.markdown(f"**{i}. {p['name']}** — {p['desc']}  ")
    if st.sidebar.button(f"Center map on {p['name']}", key=p['name']):
        # If the user clicks, open Google Maps in new tab (Streamlit can't programmatically recenter folium map easily client-side here)
        webbrowser.open_new_tab(f"https://www.google.com/maps/search/?api=1&query={p['lat']},{p['lon']}")

# Write requirements.txt file for Streamlit Cloud
REQS = """
streamlit
folium
streamlit-folium
"""

req_path = os.path.join(os.getcwd(), "requirements.txt")
try:
    with open(req_path, "w", encoding="utf-8") as f:
        f.write(REQS.strip() + "\n")
    st.success("requirements.txt written to the app folder (Streamlit Cloud will use it).")
except Exception as e:
    st.error(f"Could not write requirements.txt: {e}")

st.info("Tip: Deploy this single file to Streamlit Cloud (app file name: streamlit_seoul_top10.py). The included requirements.txt will be used by Streamlit Cloud to install dependencies.")

# Footer / credits
st.markdown("---")
st.caption("Coordinates used in this demo are taken from public map/Wikipedia sources and are approximate — good enough for marker placement in a visitor map.")

# End of app
